name: colav_unsafe_set_gen CI/CD
run-name: ${{ github.actor }} is testing colav_unsafe_set_gen pypi pkg ðŸš€

on:
  push:
    branches: [main]
  pull_request: 
    branches: [main]
  release: 
    types: [created]

jobs: 
  test: 
    name: Run Tests
    runs-on: ubuntu-latest

    steps: 
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with: 
          python-version: "3.10"

      - name: Install build tools
        run: pip install build twine setuptools

      - name: Build unsafe_set_gen pkg
        run: python -m build

      - name: Publish pkg to PyPI
        if: github.event_name == 'release'
        env: 
          PYPI_USERNAME: __token__
          PYPI_PASSWORD: ${{ secrets.PYPI_API_TOKEN }}
        run: twine upload -u "$PYPI_USERNAME" -p "$PYPI_PASSWORD" dist/*
